= form_for @artwork, :html => { :class => 'form-horizontal', :multipart => true } do |f|
  - if @artwork.errors.any?
    #error_explanation
      %h2= "#{pluralize(@artwork.errors.count, "error")} prohibited this artwork from being saved:"
      %ul
        - @artwork.errors.full_messages.each do |msg|
          %li= msg

  .field.control-group
    = f.label :size, :class => 'control-label'
    .controls
      = f.select :size, options_for_select(resolution_list.map { |re| [re, re] }, @artwork.size)
  %hr
  .field.control-group
    = f.label :ad_venders, :class => 'control-label'
    .controls#ad_venders
  %hr
  .field.control-group
    = f.label :product, :class => 'control-label'
    .controls
      = f.select :product_id, options_from_collection_for_select(Product.all, "id", "name")
  %hr
  .field.control-group
    = f.label :artwork, :class => 'control-label'
    .controls
      - if @artwork.artwork?
        = image_tag @artwork.artwork.url
      = f.file_field :artwork
  %hr
  .actions.control-group
    .controls
      = f.submit 'Save', :class => 'btn btn-primary'
      = link_to 'Back', artworks_path, :class => 'btn'

:javascript
  ad_vender_ids = "#{@artwork.ad_vender_ids}"

:coffee
  $(document).ready ->
    fetchAdVenders($('#artwork_size').val())
    $('#artwork_size').change (e) ->
      $("#ad_venders").html ''
      fetchAdVenders(e.target.value)

  fetchAdVenders = (size) ->
    $.getJSON '/ad_venders/indexOfSize', { size: size }, (data) ->
      data.forEach (adr) ->
        checked = if ad_vender_ids.indexOf(adr.id) is -1 then null else 'checked'
        html = "<input id='artwork[ad_vender_ids]' type='checkbox' name='artwork[ad_vender_ids][]' value='" + adr.id + "' " + checked + ">" + adr.name
        $("#ad_venders").append html
